# ゲームデザイン仕様

レトロ風相撲バトルゲーム（MVP）のゲームメカニクスとバランス設計を説明します。

## ゲームコンセプト

レトロな8bitスタイルで、シンプルな操作で楽しむ短時間完結型の相撲バトルゲーム。

### コアループ（MVP）

```
タイトル画面
    ↓
試合開始
    ↓
1本勝負（AI対戦、1ラウンド）
    ↓
リザルト表示（勝敗のみ）
    ↓
連続挑戦 / タイトルへ戻る
```

### プレイ時間

- 1ラウンド: 1〜2分（1本勝負）
- 1試合=1ラウンドで結果確定
- シンプルな勝敗のみ、テンポよく連戦可能

**将来拡張** (Phase 3):
- 番付システム（勝敗に応じて昇降）
- 連勝カウント
- 昇進演出

## バトルメカニクス

### 力士のステータス（MVP版：固定値）

MVPでは全力士が同一の基本ステータスを持ちます：

```typescript
interface Actor {
  id: string;
  position: Vector3;
  hp: number;         // 現在HP: 0-100
  maxHp: number;      // 最大HP: 100（固定）
  state: ActorState;  // idle | attacking | damaged | defeated
}
```

**固定パラメータ**:
- プレイヤー: HP 100（固定）
- 対戦相手: HP 100（固定）
- 移動速度: 3.0 units/s（固定）
- アクション威力: 固定値（下記参照）

**将来拡張** (Phase 3):
- ステータス育成システム（力・速さ・体力）
- ステータスによる威力・速度の変動

### HP システム

**HP範囲**: 0-100

**ダメージ源**:
- 押す: 10ダメージ
- つっぱり: 1ヒット3ダメージ（連打可能）
- スペシャル技A: 30ダメージ
- スペシャル技B: 15ダメージ（複数ヒット）

**HP回復**: 試合終了時に全回復（1本勝負）

### アクションシステム

#### 押す（Push）

**特徴**:
- 近距離攻撃
- 強力なノックバック
- 土俵外押し出しに有効

**パラメータ**（MVP版：固定値）:
- ダメージ: 10
- ノックバック: 2.0 ユニット
- 有効射程: 2.0 ユニット
- クールダウン: 300ms

**戦略**:
- 土俵際での決定打
- 相手の攻撃に合わせてカウンター

#### つっぱり（Tsuppari）

**特徴**:
- 連打可能な攻撃
- ゲージが溜まりやすい
- ダメージ蓄積向き

**パラメータ**（MVP版：固定値）:
- 1ヒットダメージ: 3
- ノックバック: 0.3 ユニット
- 有効射程: 1.5 ユニット
- クールダウン: 200ms

**戦略**:
- ゲージ溜めに最適
- 相手を押し込みながらダメージ蓄積

#### スペシャル技A: 強押し出し

**特徴**:
- 溜めモーションからの一撃
- 超強力なノックバック
- 土俵外に押し出しやすい

**パラメータ**（MVP版：固定値）:
- ダメージ: 30
- ノックバック: 5.0 ユニット
- 有効射程: 2.5 ユニット
- ゲージ消費: 100
- 溜め時間: 0.5秒

**演出**:
- カメラ軽くズーム
- スローモーション（0.3秒）
- インパクトエフェクト

**戦略**:
- 土俵際での逆転技
- 高ダメージでHP削り

#### スペシャル技B: 連撃バースト

**特徴**:
- 短時間の連続攻撃
- 複数ヒット
- スタン効果

**パラメータ**（MVP版：固定値）:
- 総ダメージ: 15（3ヒット × 5ダメージ）
- ノックバック: 0.5 ユニット（最終ヒットのみ）
- 有効射程: 2.0 ユニット
- ゲージ消費: 100
- 発動時間: 1.0秒

**演出**:
- 連続攻撃エフェクト
- ヒットストップ
- スタンエフェクト

**戦略**:
- 中距離での安全なダメージ源
- ゲージ消費効率良い

### クールダウンシステム

各アクションには個別のクールダウンが設定されています：

```typescript
const cooldowns = {
  push: 300,      // ms
  tsuppari: 200,  // ms
  special_a: 0,   // ゲージのみで制限
  special_b: 0    // ゲージのみで制限
};
```

**クールダウン中の表示**:
- ボタンが暗くなる
- 残り時間を円形プログレスで表示
- タップ不可

### ゲージシステム

**ゲージ範囲**: 0-100

**ゲージ増加**:
- 攻撃ヒット時: +5
- 被弾時: +3
- 時間経過: なし

**ゲージ消費**:
- スペシャル技使用: -100

**ゲージ戦略**:
- つっぱり連打で素早く溜める
- 被弾してもゲージが溜まる（リスクリターン）
- タイミングを見てスペシャル発動

## 土俵システム

### 土俵仕様

```typescript
const ringSpec = {
  radius: 4.5,     // ユニット
  height: 0.1,     // 地面からの高さ
  fallThreshold: 5.0  // 落下判定距離
};
```

### 境界判定

**土俵内**:
- 力士の中心が半径4.5ユニット以内
- 通常の戦闘が可能

**土俵外**:
- 力士の中心が半径4.5ユニットを超える
- 即座に落下判定
- 試合終了

**判定タイミング**:
- 毎フレーム判定
- ノックバック直後も判定

### ポジショニング戦略

**中央制圧**:
- 土俵中央を支配すると有利
- すべての方向に攻撃可能
- 土俵外に押し出されにくい

**土俵際の攻防**:
- 土俵際では押し出しリスク大
- スペシャル技でカウンター狙い
- 相手を土俵外に追い込む

## AIシステム（対戦相手）

### AI行動パターン

**基本行動**:
1. プレイヤーに接近
2. 射程内なら攻撃
3. ゲージ満タンならスペシャル使用
4. HPが低い場合は距離を取る

**難易度調整**（将来実装）:
- Easy: 反応速度遅い、攻撃単調
- Normal: バランス型
- Hard: 反応速度速い、スペシャル使用タイミング良い

**現在の実装**:
- シンプルなルールベースAI
- ランダム性を含む行動選択
- プレイヤーとほぼ同等のステータス

## マッチルール（MVP）

### 1本勝負（1ラウンド制）

MVPでは番付システムを省き、シンプルな1本勝負に集中します。

- 1ラウンドで勝敗確定（1〜2分想定）
- 勝敗条件: 土俵外に落とす / HPを0にする
- 試合終了時にHP・ゲージ全回復して次の取り組みへ

### リザルト表示（MVP版）

**表示内容**:
- 勝敗結果（WIN / LOSE）
- 試合時間
- 与えたダメージ / 受けたダメージ
- スペシャル技使用回数

**将来拡張** (Phase 3):

番付システムと昇進メカニクス:
- 初期番付: 幕下18枚目
- 勝敗による昇降格（勝ち: +1段、負け: -1段）
- 番付ラダー: 幕下18 → ... → 幕下1 → 十両 → 前頭 → 小結 → 関脇 → 大関 → 横綱
- 昇進条件（連勝ボーナス）:
  - 関脇で2連勝 → 大関昇進
  - 大関で3連勝 → 横綱昇進
- リザルト画面に番付・連勝数・昇進演出を追加

## バランス設計

### ダメージバランス

```
押す: 10ダメージ
├→ 1回で10%削る
├→ 土俵外狙いに有効
└→ リスク中、リターン中

つっぱり: 3ダメージ/ヒット
├→ 連打で高DPS
├→ ゲージ溜めに最適
└→ リスク低、リターン中

スペシャルA: 30ダメージ
├→ 1回で30%削る
├→ 土俵外確定級
└→ リスク高、リターン大

スペシャルB: 15ダメージ
├→ 安全に15%削る
├→ スタン効果あり
└→ リスク低、リターン中
```

### 試合時間バランス

**想定試合時間**:
- 1本勝負: 30-90秒（最大でも約2分）
- 最速決着: 10-20秒（土俵外1回）
- 長期戦: 2-3分（HP削り切り）
- 1試合ごとに即リスタートできるテンポを重視

**時間調整の要素**:
- クールダウン（攻撃頻度）
- ダメージ量（HP削り速度）
- 移動速度（接近時間）

## ゲームバランス調整

### 調整可能なパラメータ

優先度順に調整を行います：

1. **ダメージ量** - 試合時間に直結
2. **クールダウン** - 攻撃頻度のバランス
3. **ノックバック距離** - 土俵外への押し出しやすさ
4. **ゲージ増加量** - スペシャル技の使用頻度

### 調整指針

**速すぎる試合**（20秒未満）:
- ダメージ量を減らす
- ノックバック距離を減らす

**遅すぎる試合**（5分以上）:
- ダメージ量を増やす
- クールダウンを短く

**スペシャル技が多すぎる**:
- ゲージ増加量を減らす
- ゲージ消費量を増やす

**スペシャル技が少なすぎる**:
- ゲージ増加量を増やす

## UXデザイン

### レトロスタイリング（MVP特徴）

MVPでは8bitゲーム風のレトロデザインを採用します。

**カラーパレット**（ゲームボーイ風）:
```css
--retro-bg: #0f380f      /* 濃い緑（背景） */
--retro-fg: #9bbc0f      /* 明るい緑（文字） */
--retro-accent: #8bac0f  /* 中間緑（ボタン） */
--retro-dark: #306230    /* 暗い緑（影） */

--hp-green: #00ff00      /* HP満タン */
--hp-yellow: #ffff00     /* HP中 */
--hp-red: #ff0000        /* HP低 */
--gauge-blue: #00ffff    /* ゲージ */
```

**フォント**:
- PixelMplusフォント（日本語対応ドット絵フォント）
- 統一感のあるレトロ表示

**UIコンポーネント**:
- 太いボーダー（4px）でクッキリした境界
- ボタンは押下時に色反転（retro-accent ↔ retro-dark）
- HP/ゲージバーは色のみで状態表示（シンプル）

**画面レイアウト**:
- 上部: HP/ゲージバー（レトロカラー）
- 中央: 3D土俵（基本ジオメトリ）
- 下部: アクションボタン3つ（レトロスタイル）

### フィードバック

**攻撃ヒット時**:
- ヒットエフェクト
- サウンド再生
- バイブレーション（対応端末）
- ダメージ数値表示

**クールダウン中**:
- ボタン暗転
- 円形プログレス表示
- タップ無効

**ゲージ満タン**:
- スペシャルボタンが光る
- サウンド通知
- バイブレーション短め

### アクセシビリティ

**色弱対応**:
- HP減少を色+形状で表示
- ボタン状態を色+明度で表示

**モーション感度**:
- 設定でカメラ演出を軽減
- スローモーション無効化

**タッチターゲット**:
- ボタンサイズ: 最低60×60px
- ボタン間隔: 最低10px
- 誤タップ防止

## 将来の拡張（Phase 3以降）

### 育成システム

**日次育成**:
- 1日1回、力・速さ・体力のいずれかを+1
- ステータス上限: 各30
- 育成による戦略の多様化

### 追加スペシャル技

**候補技**:
- 回転投げ: 土俵外に投げ飛ばす
- 豪腕つかみ: 一定時間相手を動けなくする
- 鉄壁ガード: 一定時間無敵

### オンライン対戦

**実装要素**:
- マッチメイキング
- ランキングシステム
- リプレイ機能

## テストとバランス調整

### テスト項目

- [ ] 1本勝負平均時間が1-2分
- [ ] スペシャル技が1試合に2-3回使用される
- [ ] 土俵外決着が30-40%
- [ ] HP削り切り決着が60-70%
- [ ] AIとプレイヤーの勝率が40-60%

### フィードバック収集

**テストプレイヤー観察**:
- どのアクションを多用するか
- ゲージ使用タイミング
- 試合時間の長さ
- ストレスポイント

**調整サイクル**:
1. パラメータ調整
2. テストプレイ
3. データ収集
4. 分析と再調整

## 参考資料

- ゲームバランス理論
- 格闘ゲームのフレームデータ
- モバイルゲームのUXベストプラクティス
